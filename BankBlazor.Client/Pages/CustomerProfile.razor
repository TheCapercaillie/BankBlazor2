@page "/customer/{Id:int}"
@using BankBlazor.Shared.Models.DTOs
@inject HttpClient Http

<h2>Customer Profile</h2>

@if (customer == null)
{
    <p>Loading...</p>
}
else
{
    <div class="customer-info">
        <p><strong>Name:</strong> @customer.Name</p>
    </div>

    <h3>Accounts</h3>
    @if (customer.Accounts != null && customer.Accounts.Any())
    {
        <ul>
            @foreach (var account in customer.Accounts)
            {
                <li>
                    Account #@account.Id – Balance: @account.Balance.ToString("C2")
                </li>
            }
        </ul>
    }
    else
    {
        <p>No accounts found.</p>
    }
}

@code {
    [Parameter] public int Id { get; set; }

    private CustomerDto? customer;

    protected override async Task OnInitializedAsync()
    {
        try
        {
            customer = await Http.GetFromJsonAsync<CustomerDto>($"api/bank/customers/{Id}");
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Error loading customer: {ex.Message}");
        }
    }
}

